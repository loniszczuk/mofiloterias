<html>
<head>
  <meta charset="UTF-8" />
  <title>Resultado de la quiniela</title>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <link rel="stylesheet" type="text/css" href="/static/css/notifications.css" />
  <link rel="stylesheet" type="text/css" href="/static/css/index.css" />
</head>
<body>
  <div id="cabezas">
    Sorteos de la fecha {{date|date:"d/m"}}<br/>
    {% for g in gamblings_summaries %}
    <div class="resumen_cabezas">
    <ul>
      {% for h in g %}
        <li>{{ h.display_name }}:
          {% if h.head_result %}
          <a href="resultados?gambling_name={{h.name}}&date={{h.date|date:"Y-m-d"}}">{{ h.head_result }}</a>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
    </div>
    {% endfor %}
  </div>

  <div>
    <div id="seleccionar_sorteo" class="formularios">
      Ver sorteos
      <form action="resultados" method="GET">
        Fecha(año-mes-dia): <input type="text" name="date" value="{{date|date:"Y-m-d"}}"/> <br/>
        Sorteo: 
        <select name="gambling_name">
          {% for g in gamblings %}
            <option value="{{ g.name }}">{{ g.display_name }}</option>
          {% endfor %}
        </select>
        <br>
        <input type="submit" value="Ver resultado" />
      </form>
    </div>
    <div id="seleccionar_extracto" class="formularios">
      Ver extractos
      <form action="extractos" method="GET">
        Fecha(año-mes-dia): <input type="text" name="date" value="{{date|date:"Y-m-d"}}"/> <br/>
        Extracto:
        <select name="summary_name">
          {% for summary_name in summaries %}
            <option value="{{ summary_name }}">{{ summary_name }}</option>
          {% endfor %}
        </select>
        <br>
        <input type="submit" value="Ver extracto" />
      </form>
    </div>
  </div>

  <div id="notifications">Eventos:<div id="events"></div></div>

  <script type="text/javascript">
    function refreshEvents() {
      $.get('/events', 
        function(data) {
          $("#events").empty();
          $("#events").append("<ul></ul>");
          
          $(data).each(function(i, e){
            $("#events ul").append("<li>" + e + "</li>");
          });
        },
        "json"
      );
      setTimeout(refreshEvents, 30000);
    }
    setTimeout(refreshEvents, 1000);
  </script>
</body>
</html>